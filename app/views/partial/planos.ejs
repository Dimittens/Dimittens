<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planos</title>
    <link rel="stylesheet" href="css/planos.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>
<body>
    <main>
        <article class="box-planos">
            <!-- Plano Mensal -->
            <section class="planos">
                <section class="box-top">
                    <h1>Plano Mensal</h1>
                    <section class="valor-box">
                        <span>R$</span>
                        <h2>60</h2>
                    </section>
                    <p class="p-tempo">Todo mês <br> Válido por 1 mês</p>
                </section>
                <section class="box-beneficios">
                    <ul class="items-lista">
                        <li class="items-beneficios"><i class="fa-solid fa-check"></i> Acesso sem anúncios</li>
                        <li class="items-beneficios"><i class="fa-solid fa-check"></i> Criação de comunidades</li>
                        <li class="items-beneficios"><i class="fa-solid fa-check"></i> Criação de publicações</li>
                        <li class="items-beneficios"><i class="fa-solid fa-check"></i> Perfil verificado e selo exclusivo</li>
                        <li class="items-beneficios"><i class="fa-solid fa-check"></i> Maior relevância em comentários</li>
                        <li class="items-beneficios"><i class="fa-solid fa-check"></i> Cupons de 5% de desconto</li>
                    </ul>
                    <input type="button" value="Comprar" class="input-comprar" onclick="comprarPlano('mensal')">
                </section>
            </section>

            <!-- Plano Trimestral -->
            <section class="planos">
                <section class="box-top">
                    <h1>Plano Trimestral</h1>
                    <section class="valor-box">
                        <span>R$</span>
                        <h2>45</h2>
                    </section>
                    <p>Todo mês <br> Válido por 3 meses</p>
                </section>
                <section class="box-beneficios">
                    <ul class="items-lista">
                        <li class="items-beneficios"><i class="fa-solid fa-check"></i> Acesso sem anúncios</li>
                        <li class="items-beneficios"><i class="fa-solid fa-check"></i> Criação de comunidades</li>
                        <li class="items-beneficios"><i class="fa-solid fa-check"></i> Criação de publicações</li>
                        <li class="items-beneficios"><i class="fa-solid fa-check"></i> Perfil verificado e selo exclusivo</li>
                        <li class="items-beneficios"><i class="fa-solid fa-check"></i> Maior relevância em comentários</li>
                        <li class="items-beneficios"><i class="fa-solid fa-check"></i> Cupons de 5% de desconto</li>
                    </ul>
                    <input type="button" value="Comprar" class="input-comprar" onclick="comprarPlano('trimestral')">
                </section>
            </section>

            <!-- Plano Anual -->
            <section class="planos">
                <section class="promo-box">
                    <section class="promo">
                        <p class="p-promo">Melhor oferta!</p>
                    </section>
                </section>
                <section class="box-top" id="valor-box-anual">
                    <h1>Plano Anual</h1>
                    <section class="valor-box">
                        <span>R$</span>
                        <h2>30</h2>
                    </section>
                    <p>Todo mês <br> Válido por 12 meses</p>
                </section>
                <section class="box-beneficios">
                    <ul class="items-lista">
                        <li class="items-beneficios"><i class="fa-solid fa-check"></i> Acesso sem anúncios</li>
                        <li class="items-beneficios"><i class="fa-solid fa-check"></i> Criação de comunidades</li>
                        <li class="items-beneficios"><i class="fa-solid fa-check"></i> Criação de publicações</li>
                        <li class="items-beneficios"><i class="fa-solid fa-check"></i> Perfil verificado e selo exclusivo</li>
                        <li class="items-beneficios"><i class="fa-solid fa-check"></i> Maior relevância em comentários</li>
                        <li class="items-beneficios"><i class="fa-solid fa-check"></i> Cupons de 5% de desconto</li>
                    </ul>
                    <input type="button" value="Comprar" class="input-comprar" onclick="comprarPlano('anual')">
                </section>
            </section>
        </article>
    </main>
    req.session?.userId
    <!-- JavaScript para Processamento de Pagamento -->
    <script>async function comprarPlano(periodo) {
        const email = prompt('Por favor, insira seu e-mail para receber os detalhes do pagamento:');
        
        if (!email) {
          alert('Você precisa inserir um e-mail válido.');
          return;
        }
      
        try {
          const response = await fetch(`/api/pagamentos/plano/${periodo}`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email }), // Envia o e-mail
          });
      
          const result = await response.json();
          
          if (result.url) {
            window.location.href = result.url; // Redireciona para a URL do QR Code
          } else {
            alert('Erro ao processar pagamento.');
          }
        } catch (error) {
          console.error('Erro ao criar pagamento:', error);
          alert('Erro ao processar pagamento.');
        }
      }
      
    </script>
</body>
</html>
